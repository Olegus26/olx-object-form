<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>CRM ‚Äî –û–±—ä–µ–∫—Ç (OLX)</title>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;margin:20px;background:#f7f8fa;color:#0f172a}
    h1{margin:0 0 16px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}
    .card{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:16px}
    .row{display:grid;grid-template-columns:180px 1fr;align-items:center;gap:10px;margin:6px 0}
    label{font-size:13px;color:#334155}
    input,select,textarea{width:100%;padding:8px 10px;border:1px solid #cbd5e1;border-radius:8px;background:#fff}
    textarea{min-height:80px}
    .muted{color:#64748b;font-size:12px}
    .actions{margin-top:16px}
    button{padding:10px 14px;border:0;border-radius:10px;background:#2563eb;color:#fff;cursor:pointer}
    .popup{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:1000}
    .popup-content{background:#fff;width:900px;max-width:92vw;margin:5% auto;padding:20px;border-radius:12px;position:relative;max-height:90%;overflow:auto;white-space:pre-wrap}
    .closeBtn{position:absolute;top:10px;right:16px;font-size:26px;cursor:pointer}
    pre{white-space:pre-wrap}
  </style>
</head>
<body>
  <h1>–§–æ—Ä–º–∞ –æ–±—ä–µ–∫—Ç–∞ (–ø–æ–¥ OLX)</h1>

  <div class="grid">
    <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
    <div class="card">
      <div class="row"><label>–¢–∏–ø –æ–±—ä–µ–∫—Ç–∞</label>
        <select id="ObjType">
          <option>–ö–≤–∞—Ä—Ç–∏—Ä–∞</option>
          <option>–ß–∞—Å—Ç—å –∫–≤–∞—Ä—Ç–∏—Ä—ã</option>
          <option>–ö–æ–º–Ω–∞—Ç–∞</option>
        </select>
      </div>
      <div class="row"><label>–ê—Ä–µ–Ω–¥–∞ / –ø—Ä–æ–¥–∞–∂–∞</label>
        <select id="ObjDealType">
          <option>–ü—Ä–æ–¥–∞–∂–∞</option>
          <option>–ê—Ä–µ–Ω–¥–∞</option>
        </select>
      </div>
      <div class="row"><label>–ö–æ–º–Ω–∞—Ç</label><input id="ObjRooms" type="number" value="3"></div>

      <div class="row"><label>–ì–æ—Ä–æ–¥</label>
        <select id="ObjCity">
          <option>–•–∞—Ä—å–∫–æ–≤</option>
          <option>–ö–∏–µ–≤</option>
          <option>–û–¥–µ—Å—Å–∞</option>
        </select>
      </div>

      <!-- ‚úÖ –ê–¥–º. —Ä–∞–π–æ–Ω -->
      <div class="row"><label>–ê–¥–º. —Ä–∞–π–æ–Ω</label>
        <select id="ObjAdmDistrict">
          <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–π–æ–Ω...</option>
          <option>–®–µ–≤—á–µ–Ω–∫—ñ–≤—Å—å–∫–∏–π</option>
          <option>–°–∞–ª—Ç—ñ–≤—Å—å–∫–∏–π</option>
          <option>–ö–∏—ó–≤—Å—å–∫–∏–π</option>
          <option>–°–ª–æ–±—ñ–¥—Å—å–∫–∏–π</option>
          <option>–û—Å–Ω–æ–≤'—è–Ω—Å—å–∫–∏–π</option>
          <option>–•–æ–ª–æ–¥–Ω–æ–≥—ñ—Ä—Å—å–∫–∏–π</option>
          <option>–ù–µ–º–∏—à–ª—è–Ω—Å—å–∫–∏–π</option>
          <option>–Ü–Ω–¥—É—Å—Ç—Ä—ñ–∞–ª—å–Ω–∏–π</option>
          <option>–ù–æ–≤–æ–±–∞–≤–∞—Ä—Å—å–∫–∏–π</option>
        </select>
      </div>

      <div class="row"><label>–†–∞–π–æ–Ω</label><input id="ObjDistrict" type="text" value="–°–∞–ª—Ç–æ–≤–∫–∞"></div>
      <div class="row"><label>–û—Ä–∏–µ–Ω—Ç–∏—Ä</label><input id="ObjOrient" type="text" value="624"></div>
      <div class="row"><label>–ú–µ—Ç—Ä–æ</label><input id="ObjMetro" type="text" value="–ù–µ—Ç"></div>
      <div class="row"><label>–£–ª–∏—Ü–∞</label><input id="ObjStreet" type="text" value="–ê–º–æ—Å–æ–≤–∞"></div>
      <div class="row"><label>‚Ññ –¥–æ–º–∞</label><input id="ObjHouseNum" type="text" value="5"></div>

      <div class="row"><label>–¶–µ–Ω–∞ (USD)</label><input id="ObjPrice" type="text" value="48000"></div>
      <div class="row"><label>–¢–µ–ª–µ—Ñ–æ–Ω</label><input id="ObjPhone" type="text" value="0501812660"></div>

      <div class="row"><label>–≠—Ç–∞–∂</label><input id="ObjStage" type="number" value="7"></div>
      <div class="row"><label>–≠—Ç–∞–∂–µ–π</label><input id="ObjStages" type="number" value="9"></div>

      <div class="row"><label>–ü–ª–∞–Ω–∏—Ä–æ–≤–∫–∞</label>
        <select id="ObjPlan">
          <option>–†–∞–∑–¥–µ–ª—å–Ω–∞—è</option>
          <option>–°–º–µ–∂–Ω–∞—è</option>
          <option>–°—Ç—É–¥–∏–æ</option>
        </select>
      </div>
      <div class="row"><label>–°–æ—Å—Ç–æ—è–Ω–∏–µ</label>
        <select id="ObjRepair">
          <option>–ö–∞–ø. —Ä–µ–º–æ–Ω—Ç</option>
          <option>–ï–≤—Ä–æ—Ä–µ–º–æ–Ω—Ç</option>
          <option>–ü–æ–¥ —á–∏—Å—Ç–æ–≤—É—é</option>
          <option>–ë–µ–∑ —Ä–µ–º–æ–Ω—Ç–∞</option>
        </select>
      </div>
    </div>

    <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
    <div class="card">
      <div class="row"><label>–ú–∞—Ç–µ—Ä–∏–∞–ª —Å—Ç–µ–Ω</label>
        <select id="ObjWalls">
          <option>–∫–∏—Ä–ø–∏—á</option>
          <option>–ø–∞–Ω–µ–ª—å</option>
          <option>–º–æ–Ω–æ–ª–∏—Ç</option>
        </select>
      </div>
      <div class="row"><label>–û–±—â–∞—è –ø–ª–æ—â–∞–¥—å</label><input id="ObjSquare" type="text" value="84.5"></div>
      <div class="row"><label>–ñ–∏–ª–∞—è –ø–ª–æ—â–∞–¥—å</label><input id="ObjLive" type="text" value="44.7"></div>

      <!-- ‚úÖ –ü–ª–æ—â–∞–¥—å –∫—É—Ö–Ω–∏ (—É —Ç–µ–±—è –ø–æ–ª–µ —É–∂–µ –µ—Å—Ç—å ‚Äî –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏–ª–∏ –≤ —à–∞–±–ª–æ–Ω) -->
      <div class="row"><label>–ö—É—Ö–Ω—è</label><input id="ObjKitchen" type="text" value="8.1"></div>

      <div class="row"><label>–°/—É</label>
        <select id="ObjWc">
          <option>—Å–æ–≤–º–µ—â—ë–Ω–Ω—ã–π</option>
          <option>—Ä–∞–∑–¥–µ–ª—å–Ω—ã–π</option>
        </select>
      </div>
      <div class="row"><label>–ë–∞–ª–∫–æ–Ω</label>
        <select id="ObjBalcony">
          <option>–µ—Å—Ç—å</option>
          <option>–Ω–µ—Ç</option>
        </select>
      </div>

      <div class="row"><label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
        <textarea id="ObjDesc">–ü—Ä–æ—Å—Ç–æ—Ä–Ω–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ –≤ —Ö–æ—Ä–æ—à–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏... üôÇüëç
- –∫—É—Ö–Ω—è 8.1 –º¬≤
- —Ä—è–¥–æ–º –º–µ—Ç—Ä–æ üöá
</textarea>
      </div>
      <div class="muted">–í —à–∞–±–ª–æ–Ω –ø–æ–π–¥—É—Ç —Ç–æ–ª—å–∫–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è OLX.</div>
    </div>
  </div>

  <div class="actions">
    <button id="makeTemplateBtn">–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω –¥–ª—è OLX</button>
  </div>

  <!-- –ü–æ–ø–∞–ø -->
  <div id="popupTemplate" class="popup">
    <div class="popup-content">
      <span class="closeBtn">&times;</span>
      <h2>–®–∞–±–ª–æ–Ω –æ–±—ä—è–≤–ª–µ–Ω–∏—è</h2>
      <pre id="templateOutput"></pre>
    </div>
  </div>

  <script>
    // ===== –£–¥–∞–ª–µ–Ω–∏–µ —ç–º–æ–¥–∑–∏, –Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–Ω–æ—Å–æ–≤/–æ—Ç—Å—Ç—É–ø–æ–≤ =====
    function stripEmojisKeepFormatting(text) {
      // –£–±–∏—Ä–∞–µ–º pictographic-—Å–∏–º–≤–æ–ª—ã (—ç–º–æ–¥–∑–∏) + –≤–∞—Ä–∏–∞—Ü–∏–∏/—Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª–∏.
      // –ü–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫/–ø—Ä–æ–±–µ–ª—ã –Ω–µ —Ç—Ä–æ–≥–∞–µ–º => —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è.
      try {
        return text
          .replace(/[\p{Extended_Pictographic}]/gu, "")
          .replace(/[\uFE0F\u200D]/g, ""); // variation selector + ZWJ
      } catch (e) {
        // –§–æ–ª–±–µ–∫ –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –¥–≤–∏–∂–∫–æ–≤ –±–µ–∑ \p{}:
        // –£–¥–∞–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã —ç–º–æ–¥–∑–∏ (–Ω–µ –∏–¥–µ–∞–ª—å–Ω–æ, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç)
        return text
          .replace(/[\u{1F300}-\u{1FAFF}]/gu, "")
          .replace(/[\u{2600}-\u{27BF}]/gu, "")
          .replace(/[\uFE0F\u200D]/g, "");
      }
    }

    // –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è OLX (+ –¥–æ–±–∞–≤–∏–ª–∏ –ê–¥–º. —Ä–∞–π–æ–Ω –∏ –ö—É—Ö–Ω—é)
    const REQUIRED_FIELDS = [
      { id: "title",          label: "–ó–∞–≥–æ–ª–æ–≤–æ–∫" },
      { id: "ObjPrice",       label: "–¶–µ–Ω–∞" },
      { id: "ObjType",        label: "–¢–∏–ø –æ–±—ä–µ–∫—Ç–∞" },
      { id: "ObjRooms",       label: "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç" },
      { id: "ObjSquare",      label: "–û–±—â–∞—è –ø–ª–æ—â–∞–¥—å" },

      // ‚úÖ –¥–æ–±–∞–≤–∏–ª–∏ –∫—É—Ö–Ω—é
      { id: "ObjKitchen",     label: "–ö—É—Ö–Ω—è" },

      { id: "ObjStage",       label: "–≠—Ç–∞–∂" },
      { id: "ObjStages",      label: "–≠—Ç–∞–∂–Ω–æ—Å—Ç—å" },

      // ‚úÖ –¥–æ–±–∞–≤–∏–ª–∏ –∞–¥–º–∏–Ω —Ä–∞–π–æ–Ω (–∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ –≤ —à–∞–±–ª–æ–Ω–µ)
      { id: "ObjAdmDistrict", label: "–ê–¥–º. —Ä–∞–π–æ–Ω" },

      { id: "ObjDesc",        label: "–û–ø–∏—Å–∞–Ω–∏–µ" },
      { id: "location",       label: "–õ–æ–∫–∞—Ü–∏—è" }
    ];

    const val = id => document.getElementById(id)?.value?.trim() ?? "";

    document.getElementById("makeTemplateBtn").onclick = function () {
      const street = val("ObjStreet");
      const house = val("ObjHouseNum");
      const rooms = val("ObjRooms");

      // –ó–∞–≥–æ–ª–æ–≤–æ–∫
      const title = `–ü—Ä–æ–¥–∞–º –∫–≤–∞—Ä—Ç–∏—Ä—É ${street} ${house}, ${rooms}-–∫–æ–º–Ω–∞—Ç–Ω–∞—è`;

      // –õ–æ–∫–∞—Ü–∏—è ‚Äî –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π —Ä–∞–π–æ–Ω
      const location = val("ObjAdmDistrict");

      // ‚úÖ –û–ø–∏—Å–∞–Ω–∏–µ –±–µ–∑ —ç–º–æ–¥–∑–∏, –Ω–æ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø–µ—Ä–µ–Ω–æ—Å–æ–≤/–æ—Ç—Å—Ç—É–ø–æ–≤
      const descRaw = document.getElementById("ObjDesc")?.value ?? "";
      const ObjDesc = stripEmojisKeepFormatting(descRaw).trimEnd();

      const fields = {
        title,
        location,
        ObjPrice: val("ObjPrice"),
        ObjType: val("ObjType"),
        ObjRooms: val("ObjRooms"),
        ObjSquare: val("ObjSquare"),
        ObjKitchen: val("ObjKitchen"),
        ObjStage: val("ObjStage"),
        ObjStages: val("ObjStages"),
        ObjAdmDistrict: val("ObjAdmDistrict"),
        ObjDesc
      };

      const lines = [];
      lines.push("–ü—Ä–æ–¥–∞–∂–∞ –∫–≤–∞—Ä—Ç–∏—Ä:");
      let i = 1;

      for (const f of REQUIRED_FIELDS) {
        const v = fields[f.id];
        if (v) {
          lines.push(`${i}. ${f.label}: ${v}`);
          i++;
        }
      }

      document.getElementById("templateOutput").innerText = lines.join("\n");
      document.getElementById("popupTemplate").style.display = "block";
    };

    document.querySelector("#popupTemplate .closeBtn").onclick = function () {
      document.getElementById("popupTemplate").style.display = "none";
    };
  </script>
</body>
</html>
